"use strict";(self["webpackChunklottery_app"]=self["webpackChunklottery_app"]||[]).push([[769],{3562:function(t,e,s){s.d(e,{Z:function(){return d}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-ball",attrs:{tabindex:"0"}},[t._t("default",(function(){return[t._v(" "+t._s(t.numProp)+" ")]}))],2)},a=[],r={props:{numProp:{number:Number,require:!0}}},n=r,o=s(1001),l=(0,o.Z)(n,i,a,!1,null,null,null),d=l.exports},1769:function(t,e,s){s.r(e),s.d(e,{default:function(){return y}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return this.$store.getters.IS_LOGGEDIN?s("div",{staticClass:"relative"},[s("div",{staticClass:"flex flex-col max-w-7xl w-11/12 mx-auto "},[s("div",{staticClass:"bg-white rounded-md shadow-md py-5 px-3  md:px-24  my-5 flex flex-col"},[s("div",{staticClass:"flex justify-between  "},[s("div",{staticClass:"flex gap-2 flex-col"},[s("span",{staticClass:"mb-2 font-semibold text-lg"},[t._v("Drawed Number:")]),s("div",{staticClass:"grid grid-rows-1 grid-cols-1 grid-flow-row gap-y-8 align-middle self-center justify-items-center text-lg font-semibold"},t._l(t.drawedNums,(function(t){return s("div",{key:t,staticClass:"flex justify-center items-center"},[s("base-ball",{attrs:{numProp:t}})],1)})),0)]),s("div",{staticClass:"flex gap-2 flex-col"},[s("span",{staticClass:"mb-2 font-semibold text-lg"},[t._v("Your Number:")]),s("div",{staticClass:"grid grid-rows-1 grid-cols-1 grid-flow-row gap-y-8 align-middle self-center justify-items-center text-lg font-semibold"},t._l(t.selectedNums,(function(e){return s("div",{key:e,staticClass:"flex justify-center items-center"},[s("base-ball",{ref:"UserNums"+e,refInFor:!0},[s("span",{staticClass:"underline decoration-gray-900"},[t._v(t._s(e))])])],1)})),0)])]),s("span",{staticClass:"my-2 font-semibold text-lg flex items-center justify-center"},[t._v("You have won: "+t._s(t.moneyWon))])])]),s("the-modal",{attrs:{showModal:t.showModal,moneyWon:this.moneyWon,drawTime:this.currentTime}})],1):t._e()},a=[],r=(s(6699),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("dialog",{ref:"dialog",staticClass:"bg-white p-3 sm:p-5 border-2 rounded-md max-w-xl w-3/4"},[s("div",{staticClass:"pb-6 text-lg font-semibold"},[t._v(" "+t._s(t.moneyWon>0?"Congratulations! You just won: "+t.moneyWon+"â‚¬":"You didn't won anything. Better luck next time!")+" ")]),s("div",{staticClass:"flex justify-between flex-wrap"},[s("base-button",{staticClass:"bg-orange-500 text-white",nativeOn:{"~click":function(e){return t.saveDraw()}}},[t._v(" Save to History ")]),s("base-button",{staticClass:"text-blue-600",nativeOn:{"~click":function(e){return t.goAtMain()}}},[t._v(" Go back ")])],1)])}),n=[],o=s(6926),l=s(4137),d={components:{"base-button":l.Z},props:{moneyWon:Number,drawTime:Date,showModal:Boolean},watch:{showModal(t){this.$nextTick((()=>{t?this.$refs.dialog.showModal():this.$refs.dialog.close()}))}},created(){this.escapeHandler=t=>{"Escape"===t.key&&this.showModal&&this.goAtMain()},document.addEventListener("keydown",this.escapeHandler)},destroyed(){document.removeEventListener("keydown",this.escapeHandler)},methods:{async saveDraw(){if(this.$store.dispatch("SET_TOAST",{show:!1,msg:"",type:""}),this.$user)try{await(0,o.ET)((0,o.hJ)((0,o.ad)(),"users",this.$user.uid,"history"),{drawTime:this.drawTime,drawNums:this.$store.getters.GET_CURRENTDRAWS,playerNums:this.$store.getters.GET_PLAYERNUMS,totalWon:this.moneyWon},{merge:!0}),this.$store.dispatch("SET_TOAST",{show:!0,msg:"Draw saved to history successfully!",type:"success"}),this.$store.commit("SET_UPDATEHISTORY",!0)}catch(t){console.error("Error adding document: ",t)}this.goAtMain()},goAtMain(){this.$store.commit("CLEAR_PLAYERNUMS",[]),this.$store.commit("CLEAR_CURRENTDRAW",[]),this.$router.push({path:"/"})}}},u=d,c=s(1001),h=(0,c.Z)(u,r,n,!1,null,null,null),m=h.exports,w=s(4665),g=s(3562),f={name:"AppDraw",components:{"the-modal":m,"base-ball":g.Z},data(){return{selectedNums:[],drawedDiv:"Loading...",drawEnded:!1,drawedNums:[],showModal:!1,winningNum:0,moneyWon:0,currentTime:null}},computed:{...(0,w.Se)(["GET_PLAYERNUMS","GET_CURRENTDRAWS"])},methods:{highlightDrawedNums(){this.drawedNums.forEach((t=>{this.selectedNums.includes(t)&&(this.winningNum++,setTimeout((()=>{this.$refs["UserNums"+t][0].$el.children[0].classList.add("animate-spin"),this.$refs["UserNums"+t][0].$el.classList.value="app-ball shadow-3d-match sm:shadow-3d-match-sm"})))}))},async startDrawn(){this.drawedDiv="";const t=()=>new Promise((t=>{setTimeout(t,"2000")}));while(this.drawedNums.length<5&&this.$user)await t().then((()=>{var t=Math.ceil(29*Math.random()+1);while(this.drawedNums.includes(t))t=Math.ceil(29*Math.random()+1);this.selectedNums.includes(t)&&(this.winningNum++,this.$refs["UserNums"+t][0].$el.children[0].classList.add("animate-spin"),this.$refs["UserNums"+t][0].$el.classList.value="app-ball shadow-3d-match sm:shadow-3d-match-sm"),this.drawedNums.push(t),this.$store.commit("ADD_CURRENTDRAW",this.drawedNums);try{(0,o.pl)((0,o.JU)((0,o.ad)(),"users",this.$user.uid),{currentNums:this.$store.getters.GET_PLAYERNUMS,drawRunning:this.$store.getters.GET_DRAWINPROG,currentDraw:this.drawedNums},{merge:!0})}catch(e){console.log("Error adding document: ",e)}this.checkWinningNums()}));5===this.drawedNums.length&&(this.currentTime=new Date,this.showModal=!0,this.$store.commit("SET_DRAWINPROG",!1),this.updateDrawingDB())},checkWinningNums(){switch(this.winningNum){case 3:this.moneyWon=5;break;case 4:this.moneyWon=10;break;case 5:this.moneyWon=20;break;default:this.moneyWon=0}},async updateDrawingDB(){if(this.$user)try{await(0,o.pl)((0,o.JU)((0,o.ad)(),"users",this.$user.uid),{drawRunning:this.$store.getters.GET_DRAWINPROG,currentNums:[],currentDraw:[]},{merge:!0})}catch(t){console.error("Error adding document: ",t)}}},mounted(){this.$nextTick((function(){this.selectedNums=this.GET_PLAYERNUMS,this.drawedNums=this.GET_CURRENTDRAWS,0!==this.drawedNums.length?(this.highlightDrawedNums(),this.startDrawn()):setTimeout((()=>{this.startDrawn()}),"1000")}))}},p=f,N=(0,c.Z)(p,i,a,!1,null,null,null),y=N.exports}}]);
//# sourceMappingURL=769.a7149031.js.map